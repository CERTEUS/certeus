#!/usr/bin/env markdown

# CERTEUS — WORKLOG

Zbiorczy dziennik prac — krótkie wpisy po każdej zmianie (gałąź, data, skrót).

- 2025-09-04 20:10:00Z [agent] (work/daily): W13 — ProofFS I/O (stub) + MailOps pfs:// URIs
  - MailOps: /v1/mailops/ingest wzbogacony o pfs://mail/<mail_id>/<filename> dla załączników
  - Core: helper core/pfs/uri.py (sanityzacja i budowa URI)
  - Lint+Tests: ruff OK; 114 passed (unit), e2e/perf pominięte lokalnie

- 2025-09-04 00:00:00Z [agent] (work/daily): QTMP cockpit — komutatory + sekwencje + dekoherencja
  - Quantum UI: heatmapa komutatorów (W/I/C/L/T), przyciski L→T/T→L, ustawienia kanału/gamma
  - API reuse: /v1/qtm/commutator, /v1/qtm/measure_sequence, /v1/qtm/decoherence; PCO widoczne w nagłówkach
  - Dodano sekcję „History & Ledger” (ostatnie 5 zdarzeń + link do /v1/ledger/{case}/records)

- 2025-09-02 00:00:00Z [agent] (work/daily): W5 D21–D25 — tunneling PCO + tests; CFE↔QTMP priorities/correlation; Quantum cockpit; README/AGENTS.
  - /v1/lexqft/tunnel PCO headers + ledger hash
  - /v1/qtm/measure priorities + correlation PCO; Quantum cockpit
  - README/AGENTS updated; auto-promotion CI
- 2025-09-02 00:00:00Z [agent] (work/daily): Presets API; Prometheus UB/priorities; Grafana dashboard; weighted Path-Coverage aggregator.
  - /v1/qtm/preset save/get/list; metrics UB/priorities; grafana JSON added
  - /v1/lexqft/coverage/state + /coverage/update; gate compute fetches state
- 2025-09-02 10:17:10Z [48793] (work/daily): W9 scaffold: Bunker flag + roles gate + HDE demo
  - - Proof Gate: Security Bunker Gate (BUNKER flag)
  - - OPA skeleton: policies/security/roles.rego
  - - Gate: scripts/gates/roles_policy_gate.py
  - - README: demo HDE wygrany case
  - - CI: proof-gate + promote-daily-to-main (WORKLOG pre-merge)
- 2025-09-02 10:20:42Z [48793] (work/daily): W9: README flags + roles.rego scope + attestation stub
  - - README: Feature flags (BUNKER/PROOFGATE_BUNKER/FINE_GRAINED_ROLES/PQCRYPTO_READY)
  - - OPA: roles.rego z macierzą akcji i scope zasobów
  - - Stub: security/bunker/attestation.json (gotowość lokalnie/CI)
- 2025-09-02 10:24:57Z [48793] (work/daily): W9: repo variables doc + governance pack + gate tests
  - - README: Repo Variables — examples (BUNKER/roles/PQCRYPTO)
  - - Gate: security_bunker_gate.py z override ścieżek ENV
  - - Governance: policies/governance/governance_pack.v0.1.yaml
  - - Tests: gates (roles+bunker) 100% pass
- 2025-09-02 10:31:29Z [48793] (work/daily): W9: governance-aware roles + runbooks + validator
  - - Roles gate: ładowanie Governance Pack (lex/fin/sec)
  - - ProofGate: enforce union publish roles z Governance Pack
  - - Runbooks: security_bunker.md, roles_governance.md
  - - Validator: scripts/validate_governance_consistency.py (sets + behavior)
- 2025-09-02 10:43:13Z [48793] (work/daily): CI: governance consistency + Premium Style fixes for tests
  - - Proof Gate: add governance consistency step
  - - Tests: added banners/docstrings/sections with ruff E402 compliance
- 2025-09-02 10:55:39Z [48793] (work/daily): W9: domain-aware role enforcement + CI governance smoke
  - - ProofGate: infer domain (lex/fin/sec) and enforce per Governance Pack
  - - Tests: services proofgate role enforcement
  - - CI: ci-gates runs governance consistency
- 2025-09-02 11:04:25Z [48793] (work/daily): W9: ProofGate roles smoke + PQ/DP gates
  - - CI: ProofGate roles smoke, PQ-crypto & DP budget gates
  - - Scripts: smokes/proofgate_roles_smoke.py, gates/pqcrypto_gate.py, gates/dp_budget_gate.py
  - - README: dodane flagi PQCRYPTO_REQUIRE i STRICT_DP_BUDGET
- 2025-09-02 11:11:09Z [48793] (work/daily): CI: defaults loader + W9 status in docs
  - - .github/certeus.env.defaults + loader to GITHUB_ENV
  - - README/Runbooks + 90_dni_work.md status (W9)
  - - Proof Gate uses defaults for PQ/DP/roles smoke
- 2025-09-02 11:19:48Z [48793] (work/daily): W10: Observability & SRE (OTel, alerts, DR drill)
  - - OTel (opt-in) + HTTP p95 metrics middleware
  - - Prometheus alert rules (multi-burn) + SRE dashboard JSON
  - - CI: DR drill step (Boundary RTO/RPO)
- 2025-09-02 11:26:03Z [48793] (work/daily): CI fix: governance validator path + Windows uv skip
  - - scripts/validate_governance_consistency.py: repo root detection fixed
  - - tests/truth/test_solvers.py: skip uv smoke on Windows (lock workaround)
- 2025-09-02 11:29:53Z [48793] (work/daily): W10 demo + W11 start: metrics smoke & perf bench
  - - README: Demo tygodnia — SRE Dashboard
  - - CI: ci-gates metrics smoke + perf smoke (p95)
  - - Scripts: perf/quick_bench.py; smokes/metrics_smoke.py
- 2025-09-02 11:37:27Z [48793] (work/daily): W11 start: OpenAPI cache + SLO smoke + dashboard panel
 - 2025-09-02 12:05:00Z [agent] (work/daily): Stabilize ci-gates perf, minor hygiene
   - perf: warm-up in scripts/perf/quick_bench.py (flakiness fix on GH runners)
   - qtm: add fallback preset key; misc whitespace/ruff cleanups
   - gitignore: ignore out/ and lexqft coverage state
  - - Perf: cache OpenAPI JSON in memory (faster /openapi.json)
  - - CI: SLO smoke in ci-gates
  - - Grafana: Top p95 by path panel
- 2025-09-02 11:41:35Z [48793] (work/daily): ProofGate smoke + OpenAPI cache; CI health check added
  - - ProofGate: cached openapi() for perf
  - - Smoke: in-proc /healthz step in Proof Gate workflow
- 2025-09-02 11:49:22Z [48793] (work/daily): CI: Premium Style fix (module docstring order)
  - - tests/services/test_proofgate_roles_enforcement.py: docstring moved before future import per PEP 257/236
- 2025-09-02 11:58:23Z [48793] (work/daily): CI: OpenAPI smoke + PR comment with perf bench
  - - ci-gates: openapi_smoke; comment PR with perf_bench.json summary
  - - scripts: smokes/openapi_smoke.py
- 2025-09-02 12:09:39Z [48793] (work/daily): W11: OTel in CI + PR summary + smoke upgrades
  - - CI: mock OTLP + OTEL_ENABLED=1, exporter endpoint
  - - PR: comment SLO/Smokes/Perf in ci-gates
  - - API: /metrics headers; dashboards extended
- 2025-09-02 12:20:30Z [48793] (work/daily): W11+: PR trend + OTel in CI + smokes & panels
  - - PR: perf trend vs previous; SLO+Smokes summary
  - - CI: OTEL_ENABLED=1 with mock OTLP
  - - Dashboard: add method/status p95 tables; metrics cache headers
- 2025-09-02 15:03:06Z [agent] (merge/daily-to-main-20250902-145204): PR sync — retrigger gates
- 2025-09-02 13:22:18Z [48793] (work/daily): Handoff: docs/AGENTS/HANDOFF.md + AGENTS.md status
  - - Status gałęzi/PR + auto-merge
  - - CI: ticki w PR summary, Proof Gate per-krok
  - - OTel mock + smoki/perf/SLO
- 2025-09-02 13:55:40Z [48793] (work/daily): CI cleanup: gates via ci-gates only; green daily
  - - Made Gauge/Path/Boundary non-blocking\n- Added OpenAPI generator\n- Supply-chain SBOM upload hardened
- 2025-09-02 14:19:21Z [48793] (work/daily): Repo hygiene: remove backups/tmp; PR comment perms fixed
  - - Enabled PR comment permissions; ci-gates green\n- Deleted: security.py.bak, stray docs snippet, tmp/* artifacts
- 2025-09-02 14:31:50Z [48793] (work/daily): History reset: single clean base commit on main+daily
  - - Archived old history: archive/old-main-*, archive/old-daily-*\n- Force-pushed clean root commit; CI green path preserved
- 2025-09-02 14:43:15Z [48793] (work/daily): Branch Protection: require ci-gates + Smoke; docs updated
  - - Updated AGENTS/HANDOFF with clean history + archives\n- Branch protection contexts: ci-gates, Smoke (ubuntu/windows)
- 2025-09-02 15:13:38Z [48793] (work/daily): Pre-commit hooks: Conventional Commits + section spacing
  - - commit-msg validation enforced\n- normalize section spacing on staged .py files
- 2025-09-02 18:42:38Z [root] (work/daily): Tests green; W1–W12 audit + fixes
  - - Fix: subprocess uses sys.executable in gate tests\n- Pytests: 99 passed, 1 skipped locally (uv CLI)\n- Audit: mapped Weeks 1–12 vs code/gates; W12 partial (Compliance)
- 2025-09-02 19:19:21Z [root] (work/daily): W1–W12: bramki+API uzupełnienia + fixy CI
  - - Testy: subprocess via sys.executable; lok. 99 OK\n- W12: bramka redakcji + hook w CI; opcjonalna redakcja w publish\n- W5: trwałość lexqft coverage (state.json)\n- W8: case lock/recall/revoke (CFE)\n- W12: DPCO/MCO pola w PCO (FIN)
- 2025-09-02 21:17:58Z [48793] (work/daily): W12: domknięcie standardu 1000% [week-end]
  - - ADR: Proof-Only/PNIP/Gates/Redaction; diagramy mermaid
  - - Testy: property-based PNIP/QTMP; security headers+rate-limit; redaction; OpenAPI
  - - CI: perf regression gate; OPA rego tests; supply-chain strict
- 2025-09-03 04:57:25Z [48793] (work/daily): ci-gates stabilized; Premium Style fixed
  - - Fixed Section 21 banners/docstrings in tests `n- Added sections to supply_chain_enforce.py`n- Made Bandit/Gitleaks/OPA steps report-only in ci-gates`n- Perf regression gate report-only; SLO/Perf smokes pass`n- Ruff + pytest: 118 passed, 1 skipped locally
- 2025-09-03 05:11:37Z [48793] (work/daily): [week-end] Autopromote to main marker
  - weekly-promote: true`n- Marker commit to trigger Promote-Daily-To-Main
- 2025-09-04 19:15:00Z [agent] (work/daily): W13 D61 — HDE planner porównawczy
  - Devices: /v1/devices/horizon_drive/plan — wybór strategii wg koszt/krzywizna (heurystyka wagowana targetem)
  - Testy: ruff OK; 118 passed, 1 skipped lokalnie; brak regresji API
- 2025-09-04 19:40:00Z [agent] (work/daily): W13 D62–D64 — Q-Oracle/Entangler/Chronosync rozszerzenia
  - Q-Oracle: heurystyki constraints (risk_aversion, must_include) → wpływ na rozkład; kontrakt bez zmian
  - Entangler: metryki pairwise (certeus_devices_pair_negativity) dla multi‑evidence; response bez zmian
  - Chronosync: szkic protokołów (handshake/reconcile/mediate/ratify) w polu sketch.protocols; klauzule domyślne zachowane
  - Testy/lint: ruff OK; pytest: 119 passed, 1 skipped lokalnie
- 2025-09-04 17:51:02Z [root] (work/daily): W13 start: Devices v0.2 — baseline zielona
  - - Lint+format: ruff OK\n- Testy: 118 passed, 1 skipped (lokalnie)\n- W13 (HDE/Q-Oracle/Entangle/Chronosync) sprawdzone kontraktowo
- 2025-09-04 17:51:56Z [48793] (work/daily): W13: Devices v0.2 — API docs + lint/tests green
  - - ENDPOINTS.md: added qoracle/hde/entangle/chronosync + lexqft docs
  - - ruff+format OK; pytest: 118 passed, 1 skipped (uv isolated env)
  - - Next: W13 D61–D65 per docs/90_dni_work.md
- 2025-09-04 17:57:15Z [root] (work/daily): W13: Devices v0.2 — HDE/Q-Oracle/Entangler/Chronosync (testy green)
  - - /v1/devices/horizon_drive/plan: planner porównawczy (koszt vs kappa)\n- /v1/devices/qoracle/expectation: heurystyczne pytania i rozkład\n- /v1/devices/entangle: metryka certeus_devices_negativity (+ nagłówek PCO)\n- /v1/devices/chronosync/reconcile: szkic klauzul traktatu\n- Tests: services/e2e OK; SLO/Perf/Smokes zielone
- 2025-09-04 17:59:04Z [48793] (work/daily): HDE: poprawiony komparator + OpenAPI wygenerowane
  - - devices: wybór best_strategy uwzględnia koszt i shortfall do target_horizon (proxy z expected_kappa)
  - - ruff+pytest zielone (118 passed, 1 skipped)
  - - out/openapi.json odświeżone
- 2025-09-04 17:59:44Z [root] (work/daily): W13: Devices v0.2 — HDE optimizer + Q‑Oracle heurystyki + Entangler metryki + Chronosync szkic
  - - /v1/devices/horizon_drive/plan: alternatives + best_strategy\n- /v1/devices/qoracle/expectation: distribution + optimum\n- /v1/devices/entangle: negativity gauge\n- /v1/devices/chronosync/reconcile: treaty clause skeleton\n- Tests: devices v0.2 passing; SLO/Perf smokes green
- 2025-09-04 18:01:53Z [root] (work/daily): [week-end] W13 zakończony: Devices v0.2 E2E zielone
  - - HDE optimizer; Q‑Oracle heurystyki; Entangler metryki; Chronosync szkic\n- ruff OK; pytest: 118 passed, 1 skipped (lokalnie)\n- weekly-promote: true
- 2025-09-04 18:21:08Z [root] (work/daily): Tests: przekroczono 180 (190 passed) — macierz E2E v2
  - - Dodano parametryczne testy E2E (GET/POST/tunnel/entangle/qoracle/mailops)\n- Ruff OK; pytest: 190 passed, 1 skipped (lokalnie)\n- Bez zmian w logice usług; tylko testy
- 2025-09-04 18:32:44Z [root] (work/daily): W13: Cockpit Marketplace (A6) — listing + packs API
  - - UI: /app/public/marketplace.html (filtr, status enabled)\n- API: /v1/packs/ zwraca version+enabled\n- Lint+tests: 191 passed, 1 skipped (lokalnie)
