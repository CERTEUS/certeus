<!--
+-------------------------------------------------------------+
|                          CERTEUS                            |
+-------------------------------------------------------------+
| FILE: clients/web/public/sec.html                           |
| ROLE: Web client page.                                      |
| PLIK: clients/web/public/sec.html                           |
| ROLA: Strona klienta web (SEC).                             |
+-------------------------------------------------------------+
-->

<!doctype html>
<html lang="pl" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CERTEUS • SEC View</title>
    <style>
      body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;margin:0;background:#111315;color:#f2f2f3}
      .container{max-width:980px;margin:24px auto;padding:0 16px}
      .card{background:#181b20;border:1px solid #2a2d33;border-radius:12px;padding:16px;margin-bottom:16px}
      h1{margin:0 0 10px;font-size:22px}
      .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
      .btn{background:#1a1c20;border:1px solid #2a2d33;color:#f2f2f3;padding:8px 12px;border-radius:10px;cursor:pointer}
      .btn:hover{background:#20242a}
      .muted{color:#9aa0a6}
      table{width:100%;border-collapse:collapse}
      th,td{border-bottom:1px solid #2a2d33;padding:8px 10px;text-align:left}
      .pill{display:inline-block;padding:4px 8px;border:1px solid #2a2d33;border-radius:999px;background:#20242a;margin-left:8px}
      input,textarea{background:#1a1c20;border:1px solid #2a2d33;border-radius:10px;color:#f2f2f3;padding:8px 10px;}
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <h1>SEC • Headers & Rate‑Limit</h1>
        <div class="row">
          <button class="btn" id="probe">Probe /health</button>
          <span id="status" class="muted"></span>
        </div>
        <pre id="headers" style="background:#0f1115;border:1px solid #2a2d33;padding:12px;border-radius:8px;overflow:auto;max-height:220px"></pre>
      </div>
      <div class="card">
        <h1>SEC • Domain Packs</h1>
        <div class="row"><input id="q" placeholder="filtr" /><button class="btn" id="refresh">Odśwież</button><span class="muted">Liczba: <span id="count" class="pill">0</span></span></div>
        <table><thead><tr><th>Nazwa</th><th>Wersja</th><th>Status</th></tr></thead><tbody id="rows"></tbody></table>
      </div>
    </div>
    <script>
      document.getElementById('probe').onclick = async ()=>{
        const t0=performance.now(); const r = await fetch('/health'); const t1=performance.now();
        const hdrs = {}; r.headers.forEach((v,k)=>hdrs[k]=v);
        document.getElementById('status').textContent = `HTTP ${r.status} • ${(t1-t0).toFixed(1)} ms`;
        document.getElementById('headers').textContent = JSON.stringify(hdrs, null, 2);
      };
      async function listPacks(){ const r=await fetch('/v1/packs/'); return r.ok?await r.json():[]; }
      function render(packs){ const q=(document.getElementById('q').value||'').toLowerCase(); const f=packs.filter(p=>!q||(p.name||'').toLowerCase().includes(q));
        const tb=document.getElementById('rows'); tb.innerHTML=f.map(p=>`<tr><td>${p.name}</td><td>${p.version||'-'}</td><td>${p.enabled?'<span class=\"pill\">enabled</span>':''} ${p.signature?'<span class=\"pill\">signed</span>':''}</td></tr>`).join('');
        document.getElementById('count').textContent=String(f.length);
      }
      async function refresh(){ render(await listPacks()); }
      document.getElementById('refresh').onclick=refresh; document.getElementById('q').oninput=refresh; refresh();
    </script>
  </body>
  </html>

