#!/usr/bin/env bpftrace
/*
 +-------------------------------------------------------------+
 |                          CERTEUS                            |
 +-------------------------------------------------------------+
 | FILE: scripts/ebpf/uvicorn_syscalls.bt                      |
 | ROLE: Count syscalls for `uvicorn` (demo)                   |
 +-------------------------------------------------------------+
*/

tracepoint:syscalls:sys_enter_* /comm == "uvicorn"/ {
  @sys[probe] = count();
}

interval:s:5 { exit(); }

