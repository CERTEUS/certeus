{
  "title": "CERTEUS — SRE Dashboard",
  "panels": [
    {
      "type": "stat",
      "title": "HTTP error rate 5m",
      "targets": [
        {
          "expr": "certeus_http_error_rate_5m"
        }
      ]
    },
    {
      "type": "stat",
      "title": "HTTP error rate 1h",
      "targets": [
        {
          "expr": "certeus_http_error_rate_1h"
        }
      ]
    },
    {
      "type": "stat",
      "title": "HTTP p95 latency (ms)",
      "targets": [
        {
          "expr": "certeus_http_p95_ms"
        }
      ]
    },
    {
      "type": "graph",
      "title": "p95 latency (ms)",
      "targets": [
        {
          "expr": "certeus_http_p95_ms"
        }
      ]
    },
    {
      "type": "table",
      "title": "Top p95 latency by path (ms)",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(certeus_http_request_duration_ms_bucket[5m])) by (le, path))"
        }
      ]
    },
    {
      "type": "table",
      "title": "p95 latency by method (ms)",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(certeus_http_request_duration_ms_bucket[5m])) by (le, method))"
        }
      ]
    },
    {
      "type": "table",
      "title": "p95 latency by status (ms)",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(certeus_http_request_duration_ms_bucket[5m])) by (le, status))"
        }
      ]
    },
    {
      "type": "table",
      "title": "p95 latency by tenant (ms)",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(certeus_http_request_duration_ms_tenant_bucket[5m])) by (le, tenant))"
        }
      ]
    },
    {
      "type": "table",
      "title": "Error rate by tenant (5m)",
      "targets": [
        {
          "expr": "sum(rate(certeus_http_requests_total{status=~\"5..\"}[5m])) by (tenant) / sum(rate(certeus_http_requests_total[5m])) by (tenant)"
        }
      ]
    },
    {
      "type": "timeseries",
      "title": "CFE • Geodesic Action (count by le)",
      "targets": [
        {
          "expr": "sum(rate(certeus_cfe_geodesic_action_bucket[5m])) by (le)",
          "legendFormat": "le={{le}}"
        }
      ]
    },
    {
      "type": "gauge",
      "title": "CFE • Horizon Mass",
      "targets": [
        {
          "expr": "certeus_cfe_horizon_mass"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 1
        }
      }
    },
    {
      "type": "gauge",
      "title": "CFE • Kappa Max",
      "targets": [
        {
          "expr": "certeus_cfe_kappa_max"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 1
        }
      }
    }
  ],
  "time": {
    "from": "now-6h",
    "to": "now"
  }
}